---
title: Assembly of the Genome in a Bottle HG004 sequencing data
author: Shaun Jackman
output:
  html_document:
    keep_md: true
---

```{r install-packages, eval=FALSE, echo=FALSE}
install.packages("dplyr")
install.packages("ggplot2")
install.packages("ggrepel")
install.packages("knitr")
install.packages("magrittr")
install.packages("readr")
install.packages("tidyr")
```

```{r load-libraries, message=FALSE}
library(dplyr)
library(ggplot2)
library(ggrepel)
library(knitr)
library(magrittr)
library(readr)
library(tidyr)
```

```{r read-data}
assembly_data_orig <- read_tsv("assembly-stats.tsv")
aligned_data_orig <- read_tsv("samtobreak.tsv")
```

```{r tidy-data}
assembly_data <- assembly_data_orig %>%
	separate(name, c("Directory", "File"), "/") %>%
	separate(File, c("Species", "Stage", "Ext")) %>%
	select(-Ext)

aligned_data <- aligned_data_orig %>%
	separate(File, c("Directory", "File"), "/") %>%
	separate(File, c("Reference", "Species", "Stage", "Ext")) %>%
	select(-Reference, -Ext)

data <- left_join(aligned_data, assembly_data,
    by = c("Directory", "Species", "Stage")) %>%
	mutate(Directory = factor(Directory, unique(Directory)),
	  Stage = factor(Stage, unique(Stage)),
  	Name = factor(Directory,
  	 	levels = c("abyss", "bcalm", "discovardenovo", "sga", "soapdenovo"),
		  labels = c(
    		"ABySS 1.9.0 k=144 + Sealer",
     		"BCALM 2.0.0",
	   		"DISCOVARdenovo 52488",
  	  	"SGA 0.10.14",
	    	"SOAPdenovo 2.04")))
```

# Plot scaffold NGA50 and total breakpoints
```{r plot-scaffold-NGA50-breakpoints}
ggplot(data) +
  aes(x = Total_breakpoints, y = Scaffold_NGA50 / 1e6, label = Name) +
  xlab("Total breakpoints") + ylab("Scaffold NGA50 (Mbp)") +
  geom_point(size = 3) +
  geom_text_repel() +
  scale_colour_brewer(name = NULL, palette = "Dark2") +
	theme_grey(28) +
	theme(legend.position = c(.35, .85))
```

# Table of assembly stats
```{r tabulate-assembly-stats}
kable(data)
```

# Table of assembly stats
```{r tabulate-aligned-stats}
kable(aligned_data)
```
